<view class="container" style="background: {{cssVars['--theme-background']}};">
  <!-- 头部 - 固定 -->
  <view class="header" style="background: {{cssVars['--theme-surface']}};">
    <view class="header-content">
      <navigator open-type="navigateBack" class="back-btn">
        <text class="icon-back">←</text>
      </navigator>
      <text class="header-title">充值中心</text>
    </view>
    <text class="header-subtitle" style="color: {{cssVars['--theme-text-secondary']}};">购买心晴币，解锁更多精美主题</text>
  </view>

  <!-- 内容区域 - 可滚动 -->
  <scroll-view class="content" scroll-y>
    <!-- 当前余额 -->
    <view class="balance-card" style="background: linear-gradient(135deg, {{cssVars['--theme-surface']}} 0%, {{cssVars['--theme-primary']}}12 100%);">
      <view class="balance-header">
        <text class="balance-label" style="color: {{cssVars['--theme-text-secondary']}};">当前余额</text>
        <view class="coin-icon-wrapper">
          <svg class="coin-icon" width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="8" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M14.5 8.5c-.5-1-1.5-1.5-2.5-1.5-2 0-3 1.5-3 3s1 3 3 3 3 1.5 3 3-1 3-3 3c-1 0-2-.5-2.5-1.5M12 3v3m0 12v3" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <text class="coin-label" style="color: {{cssVars['--theme-primary']}};">心晴币</text>
        </view>
      </view>
      <text class="balance-amount" style="color: {{cssVars['--theme-text-primary']}};">{{userCoins}}</text>
    </view>

    <!-- 充值套餐 -->
    <view class="section">
      <text class="section-title">选择充值套餐</text>
      <view class="packages-grid">
        <view
          wx:for="{{packages}}"
          wx:key="id"
          class="package-card {{selectedPackage === item.id ? 'selected' : ''}}"
          bindtap="onPackageSelect"
          data-id="{{item.id}}"
          style="background: linear-gradient(135deg, {{cssVars['--theme-surface']}} 0%, {{selectedPackage === item.id ? cssVars['--theme-primary'] : cssVars['--theme-secondary']}}{{selectedPackage === item.id ? '15' : '08'}} 100%); border-color: {{selectedPackage === item.id ? cssVars['--theme-primary'] : cssVars['--theme-border']}};"
        >
          <!-- 热门/VIP标签 -->
          <view wx:if="{{item.hot}}" class="package-badge hot" style="background: {{cssVars['--theme-accent']}};">
            <text class="badge-text">最热</text>
          </view>
          <view wx:if="{{item.vip}}" class="package-badge vip" style="background: {{cssVars['--theme-secondary']}};">
            <text class="badge-text">VIP</text>
          </view>

          <!-- 选中标记 -->
          <view wx:if="{{selectedPackage === item.id}}" class="package-check" style="background: {{cssVars['--theme-primary']}};">
            <text class="check-icon">✓</text>
          </view>

          <!-- 图标 -->
          <view class="package-icon" style="background: {{cssVars['--theme-primary']}}15; color: {{cssVars['--theme-primary']}};">
            <block wx:if="{{item.iconText === 'gift'}}">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <rect x="4" y="9" width="16" height="12" rx="1" stroke="{{cssVars['--theme-primary']}}" stroke-width="2"/>
                <line x1="12" y1="9" x2="12" y2="21" stroke="{{cssVars['--theme-primary']}}" stroke-width="1.5"/>
                <path d="M4 12h16" stroke="{{cssVars['--theme-primary']}}" stroke-width="1.5"/>
                <path d="M7 9c0-2 1-4 5-4s5 2 5 4" stroke="{{cssVars['--theme-primary']}}" stroke-width="1.5"/>
              </svg>
            </block>
            <block wx:elif="{{item.iconText === 'coins'}}">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="8" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M14.5 8.5c-.5-1-1.5-1.5-2.5-1.5-2 0-3 1.5-3 3s1 3 3 3 3 1.5 3 3-1 3-3 3c-1 0-2-.5-2.5-1.5M12 3v3m0 12v3" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </block>
            <block wx:elif="{{item.iconText === 'zap'}}">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </block>
            <block wx:elif="{{item.iconText === 'crown'}}">
              <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 17 L12 2 L21 17 L12 22 Z" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 2 L12 22" stroke="{{cssVars['--theme-primary']}}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </block>
            <text wx:else class="icon-text">{{item.iconText}}</text>
          </view>

          <!-- 标签 -->
          <text class="package-label" style="color: {{cssVars['--theme-text-secondary']}};">{{item.label}}</text>

          <!-- 心晴币数量 -->
          <view class="package-coins">
            <text class="coins-amount">{{item.coins}}</text>
            <text wx:if="{{item.bonus > 0}}" class="coins-bonus" style="color: {{cssVars['--theme-accent']}};">+{{item.bonus}}</text>
            <text class="coins-unit" style="color: {{cssVars['--theme-text-secondary']}};">币</text>
          </view>

          <!-- 价格 -->
          <text class="package-price" style="color: {{cssVars['--theme-primary']}};">¥{{item.price}}</text>

          <!-- 赠送提示 -->
          <view wx:if="{{item.bonus > 0}}" class="package-bonus-tip" style="background: {{cssVars['--theme-accent']}}15; color: {{cssVars['--theme-accent']}};">
            <text class="bonus-text">赠送{{item.bonus}}币</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 温馨提示 -->
    <view class="tips-section">
      <view class="tips-card" style="background: {{cssVars['--theme-primary']}}10;">
        <text class="tips-title" style="color: {{cssVars['--theme-primary']}};">温馨提示</text>
        <view class="tips-list">
          <text class="tip-item" style="color: {{cssVars['--theme-text-secondary']}};">• 心晴币可用于购买精美主题</text>
          <text class="tip-item" style="color: {{cssVars['--theme-text-secondary']}};">• 心晴币永久有效，不会过期</text>
          <text class="tip-item" style="color: {{cssVars['--theme-text-secondary']}};">• 充值成功后即时到账</text>
          <text class="tip-item" style="color: {{cssVars['--theme-text-secondary']}};">• 主题一经购买永久使用</text>
        </view>
      </view>
    </view>

    <!-- 支付方式 -->
    <view class="section">
      <text class="section-title">支付方式</text>
      <view class="payment-method" style="background: {{cssVars['--theme-surface']}};">
        <view class="payment-info">
          <view class="payment-icon wechat">
            <text class="payment-icon-text">微信</text>
          </view>
          <text class="payment-name">微信支付</text>
        </view>
        <view class="payment-radio" style="border-color: {{cssVars['--theme-primary']}}; background: {{cssVars['--theme-primary']}};">
          <view class="radio-dot"></view>
        </view>
      </view>
    </view>

    <!-- 底部占位 -->
    <view class="bottom-placeholder"></view>
  </scroll-view>

  <!-- 底部购买按钮 -->
  <view class="purchase-footer">
    <button
      class="purchase-btn {{selectedPackage ? '' : 'disabled'}}"
      style="background: {{cssVars['--theme-primary']}};"
      bindtap="onPurchase"
      disabled="{{!selectedPackage}}"
    >
      <svg class="purchase-icon" width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <rect x="1" y="4" width="22" height="16" rx="2" ry="2" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <line x1="1" y1="10" x2="23" y2="10" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <text class="purchase-text">
        {{selectedPackage ? '立即支付 ¥' + selectedPackagePrice : '请选择充值套餐'}}
      </text>
    </button>
  </view>
</view>
